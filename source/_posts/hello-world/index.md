---
title: Hello World 及这博客的来由
date: 2023-04-22 22:58:03
tags:
excerpt: <img src="/post/hello-world/cu.jpg"><p>就是为了这点儿醋包的饺子</p>
---

![就是为了这点醋包的饺子.jpg](./cu.jpg)

## Hello World

老早就想着整一个博客了，但是本来就没啥记东西的习惯，而且找了半天博客的样式也没有个自己满意的，还懒，于是一拖再拖。

但是某天跟朋友聊天时谈及博客的评论系统，朋友抱怨几个无服务器需求的博客评论系统实现要么带的 js 体积过于庞大要么实现比较灵车，也不满意使用 GitHub Issue 的方式储存评论的 Git talk，最后需求是要有个体积小、支持富文本、支持匿名、登录方便的评论系统。正好那几天俺闲得无聊在刷各个开源项目的 mailing list，一瞧哟呵这邮件不就本身支持富文本，编辑器交给邮件客户端后也不用网页里拖着个markdown编辑器了，而且本身各平台注册多少都得绑定邮箱，这下直接用邮箱发送评论了，那岂不是省得注册也不用登录了啦？俺寻思这想法妙，当即准备写个 demo 出来，然后发现缺个博客，遂罢。

过了很久之后的另一个某天，俺刷着刷着 [MDN](https://developer.mozilla.org/zh-CN/docs/Learn/HTML/Introduction_to_HTML/Creating_hyperlinks#%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E9%93%BE%E6%8E%A)，发现欸这 `mailto:` 链接居然可以直接指定主题和内容，突然发觉自己好像忘了些什么，想了半天，想起自己好像是想过写个基于邮件的评论系统的点子，要用了这链接岂不快哉：有个装模做样的评论栏，写好东西后一个链接给你送进邮件客户端里，再一点就能发送。但俺觉着不妙，这再不记点东西下来以后真给自己的好想法忘了，于是搞一个博客的计划被正式提上日程，然后又鸽了两周。

本着有轮子我就是不用就要从头造的原则，真开始动手时俺打算直接新搞个博客框架得了，然后发现了几个问题，一是写了半天的 CSS 发现俺除了 imgui 那种黑框框灰条条的设计外真写不出啥更好看的了，二是巨多细节没有考虑到，写出的轮子除了能渲染个 markdown 之外啥都干不了，由此得出几个结论：

1. 俺是个傻逼
2. 俺的审美有问题
3. 有轮子还是得用轮子

于是在一番毫无意义的折腾之后，俺最后还是选择了 hexo，主题选了个够简单的。饺子包完了就到了这点儿醋的部分，首先得解决的问题是真正的邮件列表可得有个服务器，咱这无服务器的得找哪个冤大头来存这评论的数据，考虑到俺穷，云数据库多少得花钱，干脆就地仓库里开个分支存得了，到时候用 raw.gihubusercontent 拉出去。

其次是邮件如何从收信箱里到 commit，因为俺的邮箱同样用的是白嫖的 Microsoft E5，可以通过 GraphAPI 提供 webhook 通知邮件收到，加个 Cloudflare worker 之类的云函数当作 API 网关，嘿，灵车一条龙得了，等哪天白嫖的全失效了也能全身而退自己开个 SMTP 服务器收信加 commit。等这个灵车一条龙架好，俺一测试，发现大大的不妙，这 GraphAPI 的 webhook 一个通知只要你没有立即回答它就会一直发，考虑到网络延迟，这意味着我的 worker API 网关会收到很多重复的通知，而对于分布式的云函数而言没有很好的进行原子性操作的方法（要加钱！），那最终就是一封回复邮件会产生多个重复回复，搞得一团糟。

实践证明，要解决灵车问题，除了加钱外一个方案是使用更灵的灵车，最后的解决方案是使用了微软的 Power Automate（没错！就是代码块拼拼乐！），在收到邮件时发送 HTTP 请求到 worker API 网关，这次就不会像 GraphAPI 的 webhook 一样重复多发了，于是问题成功解决，拼拼乐还可以帮忙把收到的邮件自动标已读和自动回复，牛逼。

最后的问题是 raw.githubusercontent 的内容及时性问题，实测一封回复邮件发完到 raw.githubusercontent 更新得 3 分钟左右，这种延迟确实非常影响用户体验，不过俺估摸着俺这博客也没什么人会回复，能做出个 demo 就算对自己交差了，遂不管。

不过折腾完这些俺发觉这邮件跟博客结合起来还能干点其他的事情，就是投稿，有一说一，要写点文章得整个 repo 拉下来再配好环境敲敲命令才能投稿回去，属实是一个痛点，俺就继续利用那灵车一条龙再加上 github action 凑了个能使用邮件投稿的超级加倍灵车，这下随时随地能上邮箱就能投稿，除了邮件里写 markdown 之外还支持直接利用邮件里的 html，附件的处理逻辑也整好了，不过俺自己能利用自己这套东西写几次东西尚且存疑。

最后整个系统的架构图如下:

<div style="display: flex; justify-content: center"><svg id="mermaidChart1" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="495.8000183105469" style="max-width: 468.1624755859375px;" viewBox="0 0 468.1624755859375 495.8000183105469"><style>#mermaidChart1 {font-family:sans-serif;font-size:16px;fill:#333;}#mermaidChart1 .error-icon{fill:#552222;}#mermaidChart1 .error-text{fill:#552222;stroke:#552222;}#mermaidChart1 .edge-thickness-normal{stroke-width:2px;}#mermaidChart1 .edge-thickness-thick{stroke-width:3.5px;}#mermaidChart1 .edge-pattern-solid{stroke-dasharray:0;}#mermaidChart1 .edge-pattern-dashed{stroke-dasharray:3;}#mermaidChart1 .edge-pattern-dotted{stroke-dasharray:2;}#mermaidChart1 .marker{fill:#333333;stroke:#333333;}#mermaidChart1 .marker.cross{stroke:#333333;}#mermaidChart1 svg{font-family:sans-serif;font-size:16px;}#mermaidChart1 .label{font-family:sans-serif;color:#333;}#mermaidChart1 .cluster-label text{fill:#333;}#mermaidChart1 .cluster-label span{color:#333;}#mermaidChart1 .label text,#mermaidChart1 span{fill:#333;color:#333;}#mermaidChart1 .node rect,#mermaidChart1 .node circle,#mermaidChart1 .node ellipse,#mermaidChart1 .node polygon,#mermaidChart1 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaidChart1 .node .label{text-align:center;}#mermaidChart1 .node.clickable{cursor:pointer;}#mermaidChart1 .arrowheadPath{fill:#333333;}#mermaidChart1 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaidChart1 .flowchart-link{stroke:#333333;fill:none;}#mermaidChart1 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaidChart1 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaidChart1 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaidChart1 .cluster text{fill:#333;}#mermaidChart1 .cluster span{color:#333;}#mermaidChart1 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaidChart1 :root{--mermaid-font-family:sans-serif;}#mermaidChart1 :root{--mermaid-alt-font-family:sans-serif;}</style><g transform="translate(0, -0.0000019073486328125)"><marker id="flowchart-pointEnd" class="marker flowchart" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="userSpaceOnUse" markerWidth="12" markerHeight="12" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker><marker id="flowchart-pointStart" class="marker flowchart" viewBox="0 0 10 10" refX="0" refY="5" markerUnits="userSpaceOnUse" markerWidth="12" markerHeight="12" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker><marker id="flowchart-circleEnd" class="marker flowchart" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></circle></marker><marker id="flowchart-circleStart" class="marker flowchart" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></circle></marker><marker id="flowchart-crossEnd" class="marker cross flowchart" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"></path></marker><marker id="flowchart-crossStart" class="marker cross flowchart" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path d="M283.32812690734863,48.599998474121094L283.32812690734863,73.5999984741211L283.32812690734863,98.5999984741211" id="L-Sender-Outlook-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-Sender LE-Outlook" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M249.0281276702881,36.587569459713684L95.84375,73.5999984741211L95.84375,118.89999771118164L95.84375,176.99999713897705L148.3575313990193,214.7999973297119" id="L-Sender-CloudflareWorker-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-Sender LE-CloudflareWorker" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M283.32812690734863,139.1999969482422L283.32812690734863,176.99999713897705L213.8641191040644,214.7999973297119" id="L-Outlook-CloudflareWorker-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-Outlook LE-CloudflareWorker" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M149.53456436562027,255.399995803833L99.21249961853027,293.19999599456787L99.21249961853027,330.99999618530273" id="L-CloudflareWorker-GithubAction-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-CloudflareWorker LE-GithubAction" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M203.58418716025864,255.399995803833L253.90625190734863,293.19999599456787L253.90625190734863,330.99999618530273" id="L-CloudflareWorker-GithubAPI-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-CloudflareWorker LE-GithubAPI" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M99.21249961853027,371.5999946594238L99.21249961853027,409.3999948501587L215.67500114440918,453.1410714734729" id="L-GithubAction-Content-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-GithubAction LE-Content" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M253.90625190734863,371.5999946594238L253.90625190734863,409.3999948501587L253.90625190734863,447.19999504089355" id="L-GithubAPI-Content-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-GithubAPI LE-Content" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M317.6281261444092,48.17896797233222L361.490629196167,73.5999984741211L361.490629196167,118.89999771118164L361.490629196167,176.99999713897705L389.50922851471046,214.7999973297119" id="L-Sender-SelfHost-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-Sender LE-SelfHost" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M404.55625343322754,255.399995803833L404.55625343322754,293.19999599456787L404.55625343322754,351.2999954223633L404.55625343322754,409.3999948501587L292.1375026702881,452.7556489413952" id="L-SelfHost-Content-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-SelfHost LE-Content" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path><path d="M321.91562843322754,135.18535428966038L420.99375343322754,176.99999713897705L410.29947616550777,214.7999973297119" id="L-Outlook-SelfHost-0" class=" edge-thickness-normal edge-pattern-solid flowchart-link LS-Outlook LE-SelfHost" style="fill:none;" marker-end="url(#flowchart-pointEnd)"></path></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(95.84375, 118.89999771118164)"><g class="label" transform="translate(-87.84375, -12.800000190734863)"><foreignObject width="175.6875" height="25.600000381469727"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">CloudflareEmailWorker</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(283.32812690734863, 176.99999713897705)"><g class="label" transform="translate(-58.16250228881836, -12.800000190734863)"><foreignObject width="116.32500457763672" height="25.600000381469727"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">HTTP webhook</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(99.21249961853027, 293.19999599456787)"><g class="label" transform="translate(-16.34375, -12.800000190734863)"><foreignObject width="32.6875" height="25.600000381469727"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">Post</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(253.90625190734863, 293.19999599456787)"><g class="label" transform="translate(-20.993749618530273, -12.800000190734863)"><foreignObject width="41.98749923706055" height="25.600000381469727"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">Reply</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(99.21249961853027, 409.3999948501587)"><g class="label" transform="translate(-66.6937484741211, -12.800000190734863)"><foreignObject width="133.3874969482422" height="25.600000381469727"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">Complete Render</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(253.90625190734863, 409.3999948501587)"><g class="label" transform="translate(-55.60625076293945, -12.800000190734863)"><foreignObject width="111.2125015258789" height="25.600000381469727"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">Direct Commit</span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(404.55625343322754, 351.2999954223633)"><g class="label" transform="translate(-55.60625076293945, -12.800000190734863)"><foreignObject width="111.2125015258789" height="25.600000381469727"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">Direct Commit</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(420.99375343322754, 176.99999713897705)"><g class="label" transform="translate(-12.875, -12.800000190734863)"><foreignObject width="25.75" height="25.600000381469727"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">API</span></div></foreignObject></g></g></g><g class="nodes"><g class="node default default" id="flowchart-Sender-39" transform="translate(283.32812690734863, 28.299999237060547)"><rect class="basic label-container" style="" rx="0" ry="0" x="-34.30000114440918" y="-20.300000190734863" width="68.60000228881836" height="40.60000038146973"></rect><g class="label" style="" transform="translate(-26.80000114440918, -12.800000190734863)"><foreignObject width="53.60000228881836" height="25.600000381469727"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Sender</span></div></foreignObject></g></g><g class="node default default" id="flowchart-Outlook-40" transform="translate(283.32812690734863, 118.89999771118164)"><rect class="basic label-container" style="" rx="0" ry="0" x="-38.58749961853027" y="-20.300000190734863" width="77.17499923706055" height="40.60000038146973"></rect><g class="label" style="" transform="translate(-31.087499618530273, -12.800000190734863)"><foreignObject width="62.17499923706055" height="25.600000381469727"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Outlook</span></div></foreignObject></g></g><g class="node default default" id="flowchart-CloudflareWorker-42" transform="translate(176.55937576293945, 235.09999656677246)"><rect class="basic label-container" style="" rx="0" ry="0" x="-74.7750015258789" y="-20.300000190734863" width="149.5500030517578" height="40.60000038146973"></rect><g class="label" style="" transform="translate(-67.2750015258789, -12.800000190734863)"><foreignObject width="134.5500030517578" height="25.600000381469727"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">CloudflareWorker</span></div></foreignObject></g></g><g class="node default default" id="flowchart-GithubAction-46" transform="translate(99.21249961853027, 351.2999954223633)"><rect class="basic label-container" style="" rx="0" ry="0" x="-58.29375076293945" y="-20.300000190734863" width="116.5875015258789" height="40.60000038146973"></rect><g class="label" style="" transform="translate(-50.79375076293945, -12.800000190734863)"><foreignObject width="101.5875015258789" height="25.600000381469727"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">GithubAction</span></div></foreignObject></g></g><g class="node default default" id="flowchart-GithubAPI-48" transform="translate(253.90625190734863, 351.2999954223633)"><rect class="basic label-container" style="" rx="0" ry="0" x="-46.400001525878906" y="-20.300000190734863" width="92.80000305175781" height="40.60000038146973"></rect><g class="label" style="" transform="translate(-38.900001525878906, -12.800000190734863)"><foreignObject width="77.80000305175781" height="25.600000381469727"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">GithubAPI</span></div></foreignObject></g></g><g class="node default default" id="flowchart-Content-50" transform="translate(253.90625190734863, 467.4999942779541)"><rect class="basic label-container" style="" rx="0" ry="0" x="-38.23125076293945" y="-20.300000190734863" width="76.4625015258789" height="40.60000038146973"></rect><g class="label" style="" transform="translate(-30.731250762939453, -12.800000190734863)"><foreignObject width="61.462501525878906" height="25.600000381469727"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">Content</span></div></foreignObject></g></g><g class="node default default" id="flowchart-SelfHost-54" transform="translate(404.55625343322754, 235.09999656677246)"><rect class="basic label-container" style="" rx="0" ry="0" x="-39.51874923706055" y="-20.300000190734863" width="79.0374984741211" height="40.60000038146973"></rect><g class="label" style="" transform="translate(-32.01874923706055, -12.800000190734863)"><foreignObject width="64.0374984741211" height="25.600000381469727"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="nodeLabel">SelfHost</span></div></foreignObject></g></g></g></g></g></svg></div>

按这 Github 三天两头可用性下降，Microsoft E5 最近又大规模扬订阅（2023年4月），这套灵车按那个可靠性链式乘法下来估计是没那么健壮，不过反正是为了那么点儿醋才包的饺子，管他妈的那么多。
